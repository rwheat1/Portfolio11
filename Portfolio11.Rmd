---
title: "Portfolio 11 -- Recreating a Bar Plot"
author: "Ryan Wheat"
date: "05/07/2023"
output: github_document
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load-packages, include = FALSE}
library(tidyr)
library(tidyverse)
library(dplyr)
library(haven)
library(gt)
```


```{r load-data, include = FALSE}

main_data <- read_rds("C://Users/12107/OneDrive/Documents/GitHub/Portfolios 2023/Portfolio9/Lens Of Virtue.RDS")

```

Background: I'm going to continue my work from my previous portfolio. That is, I'm going to see whether competence over moral traits more for coworkers than for others.

```{r coworker competence vs. morality comaprison}

#wide to long 

mc_anova_data <- main_data %>%
  select(1, 14, 16, 18) %>%
  filter(!is.na(child_moral_v_comp) & !is.na(coworker_moral_v_comp) & !is.na(friend_moral_v_comp)) %>%
  pivot_longer(!ID, names_to = "Target", values_to = "Moral_Choices")

#run ANOVA

target_competence <- aov(Moral_Choices ~ Target + Error(ID), data = mc_anova_data)

summary(target_competence)

```

It seems that there is a difference between the ideal friends, coworkers, and children in the extent to which people prefer them to have moral trait over competence traits. Lets see if this is also true for moral vs. sociable traits.

```{r coworker soc v moral comparison}

#wide to long

ms_anova_data <- main_data %>%
  select(1, 15, 17, 19) %>%
  filter(!is.na(child_moral_v_soc) & !is.na(coworker_moral_v_soc) & !is.na(friend_moral_v_soc)) %>%
  pivot_longer(!ID, names_to = "Target", values_to = "Moral_Choices")

#run ANOVA

target_sociab <- aov(Moral_Choices ~ Target + Error(ID), data = ms_anova_data)

summary(target_sociab)

```

Interesting. I wasn't necessarily expecting people to pick moral traits over sociable traits to a different extent for the ideal friend, coworker, or child.

Let's run some follow up tests to see what might be going on here. First, I'll make a difference score between moral vs. competence and moral vs. sociable for each target (positive scores = people preferred moral traits over competence traits MORE OFTEN than moral traits over sociable traits). Then, I'll run some t-tests to see which of these are different from each other.

```{r new variable}

main_data <- main_data %>%
  mutate(mc_child_diff = child_moral_v_comp - child_moral_v_soc) %>%
  mutate(mc_coworker_diff = coworker_moral_v_comp - coworker_moral_v_soc) %>%
  mutate(mc_friend_diff = friend_moral_v_comp = friend_moral_v_soc)

```


